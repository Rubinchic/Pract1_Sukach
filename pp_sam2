import requests

API_KEY = "17da989e3d3c70a730c374476fe73f67"
CITIES = ["Kyiv", "Lviv"]

def get_coordinates(city):
    url = f"http://api.openweathermap.org/geo/1.0/direct?q={city}&limit=1&appid={API_KEY}"
    response = requests.get(url).json()
    if response:
        return response[0]['lat'], response[0]['lon']
    return None, None

def get_air_quality(lat, lon):
    url = f"http://api.openweathermap.org/data/2.5/air_pollution?lat={lat}&lon={lon}&appid={API_KEY}"
    response = requests.get(url).json()
    if "list" in response:
        return response['list'][0]['main']['aqi']  # Air Quality Index (1-5)
    return None

safety_levels = {
    1: "–î—É–∂–µ –¥–æ–±—Ä–µ",
    2: "–î–æ–±—Ä–µ",
    3: "–ó–∞–¥–æ–≤—ñ–ª—å–Ω–æ",
    4: "–ü–æ–≥–∞–Ω–æ",
    5: "–ù–µ–±–µ–∑–ø–µ—á–Ω–æ"
}

grouped_data = {level: [] for level in safety_levels}

for city in CITIES:
    lat, lon = get_coordinates(city)
    if lat is None:
        print(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –¥–ª—è {city}")
        continue

    aqi = get_air_quality(lat, lon)
    if aqi is None:
        print(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –ø—Ä–æ –ø–æ–≤—ñ—Ç—Ä—è –¥–ª—è {city}")
        continue

    grouped_data[aqi].append(city)

    if aqi >= 4:
        print(f"‚ö† –£–í–ê–ì–ê! –£ –º—ñ—Å—Ç—ñ {city} —è–∫—ñ—Å—Ç—å –ø–æ–≤—ñ—Ç—Ä—è ‚Äî {safety_levels[aqi]}!")

print("\nüìä –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –∑–∞ —Ä—ñ–≤–Ω—è–º–∏ —è–∫–æ—Å—Ç—ñ –ø–æ–≤—ñ—Ç—Ä—è:")
for level in sorted(grouped_data.keys()):
    cities = grouped_data[level]
    if cities:
        print(f"{safety_levels[level]} ({level}): {', '.join(cities)}")
